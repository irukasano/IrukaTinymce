tinymce.PluginManager.add("smileys",function(t,i){function e(){var t;return t='<table role="presentation" class="mce-grid">',tinymce.each(g,function(i){t+="<tr>",tinymce.each(i,function(i){t+='<td><a href="#" data-mce-url="'+i.url+'" tabindex="-1" title="'+i.title+'"><img src="'+i.url+'" style="width: 32px; height: 32px"></a></td>'}),t+="</tr>"}),t+="</table>"}function r(t){var i=tinymce.each,e=[];return i(t,function(t){e=e.concat(t)}),e.length>0?e:t}function u(t,i,e,r,u){function m(t,i){i=i||0;var e=t.index;if(i>0){var r=t[i];e+=t[0].indexOf(r),t[0]=r}return[e,e+t[0].length,[t[0]]]}function l(t){var i;if(3===t.nodeType)return t.data;if(c[t.nodeName]&&!a[t.nodeName])return"";if(i="",(a[t.nodeName]||h[t.nodeName])&&(i+="\n"),t=t.firstChild)do i+=l(t);while(t=t.nextSibling);return i}function o(t,i,e){var r,u,m,l,o=[],g=0,s=t,n=i.shift(),d=0;t:for(;;){if((a[s.nodeName]||h[s.nodeName])&&g++,3===s.nodeType&&(!u&&s.length+g>=n[1]?(u=s,l=n[1]-g):r&&o.push(s),!r&&s.length+g>n[0]&&(r=s,m=n[0]-g),g+=s.length),r&&u){if(s=e({startNode:r,startNodeIndex:m,endNode:u,endNodeIndex:l,innerNodes:o,match:n[2],matchIndex:d}),g-=u.length-l,r=null,u=null,o=[],n=i.shift(),d++,!n)break}else{if((!c[s.nodeName]||a[s.nodeName])&&s.firstChild){s=s.firstChild;continue}if(s.nextSibling){s=s.nextSibling;continue}}for(;;){if(s.nextSibling){s=s.nextSibling;break}if(s.parentNode===t)break t;s=s.parentNode}}}function g(t){var i;if("function"!=typeof t){var e=t.nodeType?t:d.createElement(t);i=function(){var t=e.cloneNode(!1);return t}}else i=t;return function(t){var e,r,u,m=t.startNode,l=t.endNode;if(m===l){var o=m;u=o.parentNode,t.startNodeIndex>0&&(e=d.createTextNode(o.data.substring(0,t.startNodeIndex)),u.insertBefore(e,o));var g=i();return u.insertBefore(g,o),t.endNodeIndex<o.length&&(r=d.createTextNode(o.data.substring(t.endNodeIndex)),u.insertBefore(r,o)),o.parentNode.removeChild(o),g}}}var s,n,d,a,c,h,f=[],y=0;if(d=i.ownerDocument,a=u.getBlockElements(),c=u.getWhiteSpaceElements(),h=u.getShortEndedElements(),n=l(i)){for(;s=t.exec(n);)f.push(m(s,r));return f.length&&(y=f.length,o(i,f,g(e))),y}}function m(i){var e,r,m=tinymce.each,l=t.selection.getNode();return"string"==typeof i.shortcut?(r=i.shortcut.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e=t.dom.create("img",{src:i.url,title:i.title}),u(new RegExp(r,"gi"),l,e,!1,t.schema)):void(Array.isArray(i.shortcut)&&m(i.shortcut,function(r){return e=t.dom.create("img",{src:i.url,title:i.title}),u(new RegExp(r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gi"),l,e,!1,t.schema)}))}var l=[[{shortcut:":Wink:",url:i+"/img/000041-medium.gif",title:"Wink"},{shortcut:":Happy:",url:i+"/img/000042-medium.gif",title:"Happy"},{shortcut:":Happy-Grin:",url:i+"/img/000043-medium.gif",title:"Happy-Grin"},{shortcut:":Wink:",url:i+"/img/000044-medium.gif",title:"Wink"},{shortcut:":Pleasure:",url:i+"/img/000045-medium.gif",title:"Pleasure"},{shortcut:":Delicious:",url:i+"/img/000046-medium.gif",title:"Delicious"},{shortcut:":Tounge-Out:",url:i+"/img/000047-medium.gif",title:"Tounge-Out"},{shortcut:":Delighted:",url:i+"/img/000048-medium.gif",title:"Delighted"},{shortcut:":Worry:",url:i+"/img/000049-medium.gif",title:"Worry"},{shortcut:":Overjoy:",url:i+"/img/000050-medium.gif",title:"Overjoy"}],[{shortcut:":Pondering:",url:i+"/img/000051-medium.gif",title:"Pondering"},{shortcut:":Weary:",url:i+"/img/000052-medium.gif",title:"Weary"},{shortcut:":Amazed:",url:i+"/img/000054-medium.gif",title:"Amazed"},{shortcut:":Angry:",url:i+"/img/000057-medium.gif",title:"Angry"},{shortcut:":Disapproval:",url:i+"/img/000059-medium.gif",title:"Disapproval"},{shortcut:":Conceited:",url:i+"/img/000060-medium.gif",title:"Conceited"},{shortcut:":Cry-Out:",url:i+"/img/000061-medium.gif",title:"Cry-Out"},{shortcut:":I-see-stars:",url:i+"/img/000062-medium.gif",title:"I-see-stars"},{shortcut:":Tears:",url:i+"/img/000063-medium.gif",title:"Tears"},{shortcut:":Cry:",url:i+"/img/000064-medium.gif",title:"Cry"}],[{shortcut:":Tired:",url:i+"/img/000065-medium.gif",title:"Tired"},{shortcut:":Shout:",url:i+"/img/000066-medium.gif",title:"Shout"},{shortcut:":Sick:",url:i+"/img/000067-medium.gif",title:"Sick"},{shortcut:":In-Love:",url:i+"/img/000992-medium.gif",title:"In Love"},{shortcut:":Crazy2:",url:i+"/img/001037-medium.gif",title:"Crazy"},{shortcut:":Distort:",url:i+"/img/001038-medium.gif",title:"Distort"},{shortcut:":Star-Struck:",url:i+"/img/000993-medium.gif",title:"Star Struck"},{shortcut:":Who-s-the-man:",url:i+"/img/000068-medium.gif",title:"Who-s-the-man"},{shortcut:":Zzzzzz:",url:i+"/img/000069-medium.gif",title:"Zzzzzz"},{shortcut:":I-m-in-love:",url:i+"/img/000070-medium.gif",title:"I-m-in-love"}],[{shortcut:":Movie-Time:",url:i+"/img/000071-medium.gif",title:"Movie-Time"},{shortcut:":Sad:",url:i+"/img/000072-medium.gif",title:"Sad"},{shortcut:":Whistling:",url:i+"/img/000073-medium.gif",title:"Whistling"},{shortcut:":Approve:",url:i+"/img/000074-medium.gif",title:"Approve"},{shortcut:":Angel:",url:i+"/img/000076-medium.gif",title:"Angel"},{shortcut:":The-Incredible-Hulk:",url:i+"/img/000077-medium.gif",title:"The-Incredible-Hulk"},{shortcut:":Girl-Teasing:",url:i+"/img/000081-medium.gif",title:"Girl-Teasing"},{shortcut:":Mad:",url:i+"/img/000099-medium.gif",title:"Mad"},{shortcut:":Heart-Chocolate-Gift:",url:i+"/img/000106-medium.gif",title:"Heart-Chocolate-Gift"},{shortcut:":All-I-See-is-Love:",url:i+"/img/000108-medium.gif",title:"All-I-See-is-Love"}],[{shortcut:":Love-Gift:",url:i+"/img/000110-medium.gif",title:"Love-Gift"},{shortcut:":Valentine-s-Day:",url:i+"/img/000113-medium.gif",title:"Valentine-s-Day"},{shortcut:":Love-Letter:",url:i+"/img/000115-medium.gif",title:"Love-Letter"},{shortcut:":i-heart-us:",url:i+"/img/000116-medium.gif",title:"i-heart-us"},{shortcut:":Valentine-Kiss:",url:i+"/img/000117-medium.gif",title:"Valentine-Kiss"},{shortcut:":Heartbeat:",url:i+"/img/000118-medium.gif",title:"Heartbeat"},{shortcut:":Heart:",url:i+"/img/000119-medium.gif",title:"Heart"},{shortcut:":Flowers-for-you:",url:i+"/img/000120-medium.gif",title:"Flowers-for-you"},{shortcut:":Roses-are-red:",url:i+"/img/000121-medium.gif",title:"Roses-are-red"},{shortcut:":Valentine-s-Day:",url:i+"/img/000122-medium.gif",title:"Valentine-s-Day"}],[{shortcut:":Be-Mine:",url:i+"/img/000125-medium.gif",title:"Be-Mine"},{shortcut:":Make-A-Birthday-Wish:",url:i+"/img/000127-medium.gif",title:"Make-A-Birthday-Wish"},{shortcut:":Happy-Birthday1:",url:i+"/img/000128-medium.gif",title:"Happy-Birthday"},{shortcut:":Happy-Birthday2:",url:i+"/img/000129-medium.gif",title:"Happy-Birthday"},{shortcut:":Happy-Birthday3:",url:i+"/img/000130-medium.gif",title:"Happy-Birthday"},{shortcut:":Devil:",url:i+"/img/000132-medium.gif",title:"Devil"},{shortcut:":Afraid:",url:i+"/img/000138-medium.gif",title:"Afraid"},{shortcut:":Hi:",url:i+"/img/000154-medium.gif",title:"Hi"},{shortcut:":Slam-Dunk:",url:i+"/img/000171-medium.gif",title:"Slam-Dunk"},{shortcut:":Beer:",url:i+"/img/000175-medium.gif",title:"Beer"}],[{shortcut:":Cool:",url:i+"/img/000177-medium.gif",title:"Cool"},{shortcut:":Smile:",url:i+"/img/000178-medium.gif",title:"Smile"},{shortcut:":Devilish:",url:i+"/img/000180-medium.gif",title:"Devilish"},{shortcut:":Cheers:",url:i+"/img/000183-medium.gif",title:"Cheers"},{shortcut:":Crazy:",url:i+"/img/000187-medium.gif",title:"Crazy"},{shortcut:":Beaten-up:",url:i+"/img/000188-medium.gif",title:"Beaten-up"},{shortcut:":Bully:",url:i+"/img/000195-medium.gif",title:"Bully"},{shortcut:":Geek:",url:i+"/img/000200-medium.gif",title:"Geek"},{shortcut:":Geek:",url:i+"/img/000201-medium.gif",title:"Geek"},{shortcut:":Geek-Girl:",url:i+"/img/000202-medium.gif",title:"Geek-Girl"}],[{shortcut:":Elvis:",url:i+"/img/000203-medium.gif",title:"Elvis"},{shortcut:":Caveman:",url:i+"/img/000204-medium.gif",title:"Caveman"},{shortcut:":Woodstock:",url:i+"/img/000209-medium.gif",title:"Woodstock"},{shortcut:":Hairstylist:",url:i+"/img/000246-medium.gif",title:"Hairstylist"},{shortcut:":Aerobics:",url:i+"/img/000248-medium.gif",title:"Aerobics"},{shortcut:":Congratulations:",url:i+"/img/000266-medium.gif",title:"Congratulations"},{shortcut:":I-Wish:",url:i+"/img/000268-medium.gif",title:"I-Wish"},{shortcut:":Yes-Sir:",url:i+"/img/000270-medium.gif",title:"Yes-Sir"},{shortcut:":I-got-an-idea:",url:i+"/img/000274-medium.gif",title:"I-got-an-idea"},{shortcut:":I-m-Bored:",url:i+"/img/000275-medium.gif",title:"I-m-Bored"}],[{shortcut:":Cry:",url:i+"/img/000276-medium.gif",title:"Cry"},{shortcut:":Princess:",url:i+"/img/000277-medium.gif",title:"Princess"},{shortcut:":Angel:",url:i+"/img/000278-medium.gif",title:"Angel"},{shortcut:":THANK-YOU:",url:i+"/img/000280-medium.gif",title:"THANK-YOU"},{shortcut:":Bye:",url:i+"/img/000291-medium.gif",title:"Bye"},{shortcut:":Birthday-Boy:",url:i+"/img/000292-medium.gif",title:"Birthday-Boy"},{shortcut:":Afraid:",url:i+"/img/000293-medium.gif",title:"Afraid"},{shortcut:":Daze:",url:i+"/img/000296-medium.gif",title:"Daze"},{shortcut:":New-Arrival--Baby-Boy:",url:i+"/img/000301-medium.gif",title:"New-Arrival--Baby-Boy"},{shortcut:":Congratulations--Baby-Girl:",url:i+"/img/000302-medium.gif",title:"Congratulations--Baby-Girl"}],[{shortcut:":Hello:",url:i+"/img/000317-medium.gif",title:"Hello"},{shortcut:":Please:",url:i+"/img/000319-medium.gif",title:"Please"},{shortcut:":Please:",url:i+"/img/000320-medium.gif",title:"Please"},{shortcut:":You-re-HOT:",url:i+"/img/000321-medium.gif",title:"You-re-HOT"},{shortcut:":Cool:",url:i+"/img/000322-medium.gif",title:"Cool"},{shortcut:":In-pain:",url:i+"/img/000336-medium.gif",title:"In-pain"},{shortcut:":Thinking:",url:i+"/img/000339-medium.gif",title:"Thinking"},{shortcut:":Tounge-Out:",url:i+"/img/000343-medium.gif",title:"Tounge-Out"},{shortcut:":Ssshh:",url:i+"/img/000358-medium.gif",title:"Ssshh"},{shortcut:":Liar:",url:i+"/img/000361-medium.gif",title:"Liar"}],[{shortcut:":Happy-Grin:",url:i+"/img/000986-medium.gif",title:"Happy-Grin"},{shortcut:":Crazy-Tounge:",url:i+"/img/000987-medium.gif",title:"Crazy-Tounge"},{shortcut:":Censored:",url:i+"/img/000988-medium.gif",title:"Censored"},{shortcut:":Crying:",url:i+"/img/000990-medium.gif",title:"Crying"},{shortcut:":Luigi:",url:i+"/img/001093-medium.gif",title:"Luigi Super Mario Bros"},{shortcut:":Mario:",url:i+"/img/001092-medium.gif",title:"Mario Super Mario Bros"},{shortcut:":Optimus-Prime:",url:i+"/img/001088-medium.gif",title:"Optimus Prime"},{shortcut:":Megatron:",url:i+"/img/001089-medium.gif",title:"Megatron"},{shortcut:":Police:",url:i+"/img/001085-medium.gif",title:"Police"},{shortcut:":Felon:",url:i+"/img/001086-medium.gif",title:"Felon"}],[{shortcut:":Green-Lantern:",url:i+"/img/001057-medium.gif",title:"Green Lantern Smiley"},{shortcut:":Jack-Sparrow:",url:i+"/img/001049-medium.gif",title:"Jack Sparrow"},{shortcut:":iPhone:",url:i+"/img/001191-medium.gif",title:"iPhone"},{shortcut:":iPad:",url:i+"/img/001192-medium.gif",title:"iPad"},{shortcut:":Doctor:",url:i+"/img/001099-medium.gif",title:"Doctor"},{shortcut:":Sad-Lonely:",url:i+"/img/001036-medium.gif",title:"Sad&Lonely"},{shortcut:":Crazy-Mad:",url:i+"/img/001037-medium.gif",title:"Crazy"},{shortcut:":Be-Happy:",url:i+"/img/001039-medium.gif",title:"Be Happy"},{shortcut:":Superman:",url:i+"/img/001040-medium.gif",title:"Superman"}]],o=t.settings.smileys||l,g=t.settings.extended_smileys?o.concat(t.settings.extended_smileys):o;t.on("keyup",function(){if(t.settings.auto_convert_smileys){var i=tinymce.each,e=t.selection,u=e.getNode();u&&i(r(g),function(t){m(t)})}}),t.addButton("smileys",{type:"panelbutton",icon:"emoticons",panel:{autohide:!0,html:e,onclick:function(i){var e=t.dom.getParent(i.target,"a");e&&(t.insertContent('<img src="'+e.getAttribute("data-mce-url")+'" title="'+e.getAttribute("title")+'" />'),this.hide())}},tooltip:"Emoticons"})});